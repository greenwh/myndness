/* src/app.css */
/* Mental Wellness Companion - Global Styles */
/* Accessibility-first design for older adult users */

@tailwind base;
@tailwind components;
@tailwind utilities;

/* ============================================
   CSS CUSTOM PROPERTIES
   ============================================ */

:root {
  /* Color scheme */
  --color-bg: #fafaf9;
  --color-bg-card: #ffffff;
  --color-bg-elevated: #ffffff;
  --color-text-primary: #18181b;
  --color-text-secondary: #52525b;
  --color-text-muted: #a1a1aa;
  --color-border: #e4e4e7;
  --color-border-focus: #3b82f6;
  
  /* Breathing colors */
  --color-breath-inhale: linear-gradient(135deg, #3b82f6, #60a5fa);
  --color-breath-hold: linear-gradient(135deg, #8b5cf6, #a78bfa);
  --color-breath-exhale: linear-gradient(135deg, #10b981, #34d399);
  
  /* Typography */
  --font-size-base: 1rem;
  --font-size-lg: 1.125rem;
  --line-height-relaxed: 1.625;
  
  /* Spacing */
  --spacing-page: 1rem;
  --spacing-section: 1.5rem;
  
  /* Transitions */
  --transition-fast: 150ms ease;
  --transition-normal: 300ms ease;
  --transition-slow: 500ms ease;
  
  /* Border radius */
  --radius-sm: 0.375rem;
  --radius-md: 0.5rem;
  --radius-lg: 0.75rem;
  --radius-xl: 1rem;
  --radius-full: 9999px;
}

/* Dark mode */
:root.dark-mode {
  --color-bg: #18181b;
  --color-bg-card: #27272a;
  --color-bg-elevated: #3f3f46;
  --color-text-primary: #fafafa;
  --color-text-secondary: #a1a1aa;
  --color-text-muted: #71717a;
  --color-border: #3f3f46;
}

/* System dark mode preference */
@media (prefers-color-scheme: dark) {
  :root:not(.dark-mode):not([class*="dark"]) {
    --color-bg: #18181b;
    --color-bg-card: #27272a;
    --color-bg-elevated: #3f3f46;
    --color-text-primary: #fafafa;
    --color-text-secondary: #a1a1aa;
    --color-text-muted: #71717a;
    --color-border: #3f3f46;
  }
}

/* High contrast mode */
:root.high-contrast {
  --color-text-primary: #000000;
  --color-text-secondary: #1a1a1a;
  --color-border: #000000;
}

/* Large font mode */
:root.font-large {
  --font-size-base: 1.125rem;
  --font-size-lg: 1.25rem;
}

:root.font-extra-large {
  --font-size-base: 1.25rem;
  --font-size-lg: 1.5rem;
}

/* ============================================
   BASE STYLES
   ============================================ */

@layer base {
  html {
    font-size: var(--font-size-base);
    scroll-behavior: smooth;
    -webkit-tap-highlight-color: transparent;
  }
  
  body {
    @apply bg-gray-50 text-gray-900 antialiased;
    font-family: 'Inter', system-ui, -apple-system, sans-serif;
    line-height: var(--line-height-relaxed);
    min-height: 100vh;
    min-height: 100dvh; /* Dynamic viewport height for mobile */
  }
  
  /* Accessible focus styles */
  *:focus {
    outline: none;
  }
  
  *:focus-visible {
    @apply ring-2 ring-primary-500 ring-offset-2;
    outline: none;
  }
  
  /* Ensure sufficient touch target size */
  button, 
  [role="button"],
  input[type="submit"],
  input[type="button"],
  a {
    min-height: 44px;
    min-width: 44px;
  }
  
  /* Improve text rendering */
  h1, h2, h3, h4, h5, h6 {
    @apply font-semibold text-gray-900;
    text-wrap: balance;
  }
  
  h1 { @apply text-3xl; }
  h2 { @apply text-2xl; }
  h3 { @apply text-xl; }
  h4 { @apply text-lg; }
  
  p {
    @apply text-gray-700;
    text-wrap: pretty;
  }
  
  /* Form elements */
  input, textarea, select {
    @apply text-base;
    font-size: 16px; /* Prevents zoom on iOS */
  }
  
  /* Links */
  a {
    @apply text-primary-600 underline decoration-primary-300 underline-offset-2;
    @apply hover:text-primary-700 hover:decoration-primary-500;
    @apply transition-colors duration-150;
  }
}

/* ============================================
   COMPONENT STYLES
   ============================================ */

@layer components {
  /* Card component */
  .card {
    @apply bg-white rounded-xl shadow-card p-4;
    @apply border border-gray-100;
  }
  
  .card-hover {
    @apply transition-shadow duration-200;
    @apply hover:shadow-card-hover;
  }
  
  /* Button base */
  .btn {
    @apply inline-flex items-center justify-center;
    @apply font-medium rounded-lg;
    @apply px-4 py-3;
    @apply min-h-touch;
    @apply transition-all duration-150;
    @apply focus-visible:ring-2 focus-visible:ring-offset-2;
    @apply disabled:opacity-50 disabled:cursor-not-allowed;
  }
  
  .btn-primary {
    @apply btn;
    @apply bg-primary-600 text-white;
    @apply hover:bg-primary-700;
    @apply focus-visible:ring-primary-500;
    @apply active:bg-primary-800;
  }
  
  .btn-secondary {
    @apply btn;
    @apply bg-gray-100 text-gray-700;
    @apply hover:bg-gray-200;
    @apply focus-visible:ring-gray-500;
  }
  
  .btn-success {
    @apply btn;
    @apply bg-success-600 text-white;
    @apply hover:bg-success-700;
    @apply focus-visible:ring-success-500;
  }
  
  .btn-danger {
    @apply btn;
    @apply bg-danger-600 text-white;
    @apply hover:bg-danger-700;
    @apply focus-visible:ring-danger-500;
  }
  
  .btn-ghost {
    @apply btn;
    @apply bg-transparent text-gray-600;
    @apply hover:bg-gray-100;
    @apply focus-visible:ring-gray-500;
  }
  
  .btn-lg {
    @apply px-6 py-4 text-lg;
    @apply min-h-[56px];
  }
  
  .btn-icon {
    @apply p-3;
    @apply min-h-touch min-w-touch;
  }
  
  /* Crisis/Emergency button */
  .btn-crisis {
    @apply btn;
    @apply bg-danger-500 text-white;
    @apply hover:bg-danger-600;
    @apply focus-visible:ring-danger-500;
    @apply shadow-lg;
    @apply text-lg font-semibold;
    @apply min-h-[56px] px-6;
  }
  
  /* Form inputs */
  .input {
    @apply w-full px-4 py-3;
    @apply text-base text-gray-900;
    @apply bg-white border border-gray-300 rounded-lg;
    @apply placeholder:text-gray-400;
    @apply focus:border-primary-500 focus:ring-2 focus:ring-primary-200;
    @apply disabled:bg-gray-100 disabled:cursor-not-allowed;
    @apply transition-colors duration-150;
    font-size: 16px; /* Prevent iOS zoom */
  }
  
  .input-error {
    @apply border-danger-500;
    @apply focus:border-danger-500 focus:ring-danger-200;
  }
  
  .textarea {
    @apply input;
    @apply min-h-[120px] resize-y;
  }
  
  /* Labels */
  .label {
    @apply block text-sm font-medium text-gray-700 mb-1.5;
  }
  
  .label-required::after {
    content: ' *';
    @apply text-danger-500;
  }
  
  /* Help text */
  .help-text {
    @apply text-sm text-gray-500 mt-1;
  }
  
  .error-text {
    @apply text-sm text-danger-600 mt-1;
  }
  
  /* Slider/Range styling */
  .slider {
    @apply w-full h-3 rounded-full;
    @apply bg-gray-200;
    @apply appearance-none cursor-pointer;
  }
  
  .slider::-webkit-slider-thumb {
    @apply appearance-none;
    @apply w-6 h-6 rounded-full;
    @apply bg-primary-600 border-2 border-white;
    @apply shadow-md;
    @apply cursor-pointer;
    @apply transition-transform duration-150;
  }
  
  .slider::-webkit-slider-thumb:hover {
    @apply transform scale-110;
  }
  
  .slider::-moz-range-thumb {
    @apply w-6 h-6 rounded-full;
    @apply bg-primary-600 border-2 border-white;
    @apply shadow-md cursor-pointer;
  }
  
  /* Progress bars */
  .progress {
    @apply w-full h-2 rounded-full bg-gray-200 overflow-hidden;
  }
  
  .progress-bar {
    @apply h-full rounded-full bg-primary-500;
    @apply transition-all duration-300 ease-out;
  }
  
  /* Badge */
  .badge {
    @apply inline-flex items-center;
    @apply px-2.5 py-0.5 rounded-full;
    @apply text-xs font-medium;
  }
  
  .badge-primary {
    @apply badge bg-primary-100 text-primary-700;
  }
  
  .badge-success {
    @apply badge bg-success-100 text-success-700;
  }
  
  .badge-warning {
    @apply badge bg-warning-100 text-warning-700;
  }
  
  .badge-danger {
    @apply badge bg-danger-100 text-danger-700;
  }
  
  /* Navigation */
  .nav-item {
    @apply flex flex-col items-center justify-center;
    @apply px-3 py-2;
    @apply text-sm text-gray-500;
    @apply transition-colors duration-150;
    @apply min-h-touch;
  }
  
  .nav-item-active {
    @apply text-primary-600;
  }
  
  .nav-item:hover {
    @apply text-gray-700;
  }
  
  /* Breathing circle */
  .breathing-circle {
    @apply rounded-full;
    @apply flex flex-col items-center justify-center;
    @apply text-white font-semibold;
    @apply transition-transform ease-in-out;
  }
  
  .breathing-inhale {
    background: var(--color-breath-inhale);
  }
  
  .breathing-hold {
    background: var(--color-breath-hold);
  }
  
  .breathing-exhale {
    background: var(--color-breath-exhale);
  }
}

/* ============================================
   UTILITY CLASSES
   ============================================ */

@layer utilities {
  /* Safe area padding for notched phones */
  .safe-bottom {
    padding-bottom: env(safe-area-inset-bottom);
  }
  
  .safe-top {
    padding-top: env(safe-area-inset-top);
  }
  
  /* Touch-friendly spacing */
  .touch-spacing > * + * {
    @apply mt-3;
  }
  
  /* Accessible hide (screen reader only) */
  .sr-only {
    @apply absolute w-px h-px p-0 -m-px overflow-hidden whitespace-nowrap border-0;
    clip: rect(0, 0, 0, 0);
  }
  
  /* Focus visible only */
  .focus-visible-only:focus:not(:focus-visible) {
    outline: none;
    box-shadow: none;
  }
  
  /* No scrollbar */
  .no-scrollbar {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  
  .no-scrollbar::-webkit-scrollbar {
    display: none;
  }
  
  /* Text selection */
  .select-all {
    user-select: all;
  }
  
  /* Disable text selection */
  .select-none {
    user-select: none;
  }
}

/* ============================================
   REDUCED MOTION
   ============================================ */

@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }

  .breathing-circle {
    transition: none !important;
  }
}

/* Manual reduced motion class (from settings) */
:root.reduce-motion *,
:root.reduce-motion *::before,
:root.reduce-motion *::after {
  animation-duration: 0.01ms !important;
  animation-iteration-count: 1 !important;
  transition-duration: 0.01ms !important;
  scroll-behavior: auto !important;
}

:root.reduce-motion .breathing-circle {
  transition: none !important;
}

/* ============================================
   PRINT STYLES
   ============================================ */

@media print {
  body {
    @apply bg-white text-black;
  }
  
  .no-print {
    display: none !important;
  }
  
  .card {
    @apply shadow-none border border-gray-300;
    break-inside: avoid;
  }
  
  a {
    @apply text-black no-underline;
  }
}
